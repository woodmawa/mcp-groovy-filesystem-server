spring:
  application:
    name: mcp-groovy-filesystem-server
  main:
    web-application-type: ${MCP_WEB_TYPE:servlet}
  jackson:
    default-property-inclusion: non_null

mcp:
  mode: ${MCP_MODE:http}
  
  filesystem:
    # Allowed directories for file operations
    # Note: C:/Users/willw covers all subdirectories including:
    #   - AppData/Roaming/Claude (config: claude_desktop_config.json)
    #   - AppData/Local/Claude (logs, cache)
    #   - .vscode-remote/Claude (remote logs)
    #   - IdeaProjects (your projects)
    #   - claude (your workspace)
    allowed-directories: C:/Users/willw/IdeaProjects,C:/Users/willw/claude,C:/Users/willw
    max-file-size-mb: 10
    enable-write: true
    # Allow following symbolic links (default: false for security)
    allow-symlinks: false
  
  # Script execution security settings
  script:
    max-memory-mb: 256
    max-threads: 10
    max-execution-time-seconds: 60
    max-script-length: 100000
    enable-dangerous-pattern-check: true
    enable-file-path-validation: true
    enable-audit-logging: true
    
    # Command whitelists (regex patterns) - can be customized without rebuild!
    whitelist:
      # Allowed PowerShell commands (regex patterns)
      powershell-allowed:
        - '^Get-ChildItem.*'
        - '^Get-Content.*'
        - '^Get-Item.*'
        - '^Test-Path.*'
        - '^Get-Location.*'
        - '^Get-Process.*'
        - '^Select-Object.*'
        - '^Where-Object.*'
        - '^Measure-Object.*'
        - '^Sort-Object.*'
        - '^Group-Object.*'
        - '^Format-.*'
        - '^Out-.*'
        - '^Write-Host.*'
        - '^Write-Output.*'
        - '.*\|.*'  # Allow piping
        - '^\\.\\\\gradlew\\.bat.*'  # Gradle wrapper (standalone)
        - '^cd .+; \\.\\\\gradlew\\.bat.*'  # cd then gradlew
        - '^cd .+;.*'  # Allow cd with any command after
        
      # Blocked PowerShell commands (takes precedence)
      powershell-blocked:
        - '.*Remove-Item.*'
        - '.*Clear-.*Content.*'
        - '.*Stop-Computer.*'
        - '.*Restart-Computer.*'
        - '.*Format-Volume.*'
        - '.*Clear-Disk.*'
        - '.*Remove-.*Disk.*'
        - '.*Invoke-Expression.*'
        - '.*Invoke-Command.*'
        - '.*Start-Process.*'
        - '.*New-Service.*'
        - '.*Set-ExecutionPolicy.*'
        
      # Allowed Bash commands (regex patterns)
      bash-allowed:
        - '^ls.*'
        - '^cat.*'
        - '^grep.*'
        - '^find.*'
        - '^wc.*'
        - '^head.*'
        - '^tail.*'
        - '^echo.*'
        - '^pwd.*'
        - '^which.*'
        - '^whoami.*'
        - '^date.*'
        - '^file.*'
        - '^stat.*'
        - '^du.*'
        - '^df.*'
        - '^ps.*'
        - '^top.*'
        - '^awk.*'
        - '^sed.*'
        - '^sort.*'
        - '^uniq.*'
        - '^tr.*'
        - '^cut.*'
        - '.*\|.*'  # Allow piping
        - '^\\./ gradlew.*'  # Gradle wrapper
        
      # Blocked Bash commands (takes precedence)
      bash-blocked:
        - '.*rm .*'
        - '.*rm-.*'
        - '.*delete.*'
        - '.*chmod.*'
        - '.*chown.*'
        - '.*mkfs.*'
        - '.*dd.*'
        - '.*sudo.*'
        - '.*su .*'
        - '.*shutdown.*'
        - '.*reboot.*'
        - '.*kill.*'
        - '.*pkill.*'
        - '.*eval.*'
        - '.*exec.*'
        - '.*source.*'
        - '.*\\.\\./.*'  # No executing files

logging:
  level:
    root: INFO
    com.softwood.mcp: DEBUG

---
# STDIO Mode Profile
# Note: Logging still enabled but goes to STDERR and file only (STDOUT reserved for MCP JSON-RPC)
spring:
  config:
    activate:
      on-profile: stdio
  main:
    banner-mode: off
server:
  port: 0

mcp:
  mode: stdio

logging:
  level:
    root: INFO
    com.softwood.mcp: DEBUG
    org.springframework: WARN
    # Keep audit logging in stdio mode
    com.softwood.mcp.service.AuditService: INFO
